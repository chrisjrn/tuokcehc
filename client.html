<html>

  <body>

    <button role="button" onClick="doThing()">Do Thing</button>


    <script type="text/javascript">

        var TUOKCEHC_PAYMENT_FRAME_ID = "tuokcehc-payment-frame"
        function doThing() {
            console.log("boop");

            /* Create background element */
            bgDiv = document.createElement("div");
            bgDiv.setAttribute("id", TUOKCEHC_PAYMENT_FRAME_ID);
            bgDiv.setAttribute(
                "style",
                "position: absolute; top: 0; left: 0; bottom: 0; right: 0; " +
                "background: rgba(0, 0, 0, 0.8); "
            );
            document.body.appendChild(bgDiv);

            /* Create containing div for iframe */
            containingDiv = document.createElement("div");
            containingDiv.setAttribute(
                "style",
                "width: 90%; max-width: 800px; height: 90%; max-height: 600px;" +
                "margin: 20px auto;"
            );
            bgDiv.appendChild(containingDiv);

            /* Create iframe */
            iframe = document.createElement("iframe");
            iframe.setAttribute("src", "form.html");
            iframe.setAttribute(
                "style",
                "width: 100%; height: 100%; border: 0;"
            );
            containingDiv.appendChild(iframe);

        }

        function closePaymentFrame() {
            element = document.getElementById(TUOKCEHC_PAYMENT_FRAME_ID);
            document.body.removeChild(element);
        }

        function receiveMessage(message) {
            console.log("message");
            console.log(message);
            closePaymentFrame();
        }

        window.addEventListener("message", receiveMessage, false);

    </script>

  </body>


</html>
